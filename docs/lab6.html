<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>MKTG402(3) Labs – lab6</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">
      MKTG402(3) Labs
      </li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">MKTG402(3) Labs</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting started with SPSS (Week 13)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Descriptive Statistics, Graphs and Charts in SPSS (Week 14)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Crosstabs and Two Independent Samples T-test (Week 15)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ANOVA and Experimentation (Week 16)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regression (Week 17)</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#sec-lab6" id="toc-sec-lab6" class="nav-link active" data-scroll-target="#sec-lab6">Mediation Analysis (Extra)</a>
  <ul class="collapse">
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link" data-scroll-target="#learning-objectives">Learning objectives</a></li>
  <li><a href="#the-model" id="toc-the-model" class="nav-link" data-scroll-target="#the-model">The Model</a></li>
  <li><a href="#sobels-test" id="toc-sobels-test" class="nav-link" data-scroll-target="#sobels-test">Sobel’s test</a></li>
  <li><a href="#using-process-macro-additional" id="toc-using-process-macro-additional" class="nav-link" data-scroll-target="#using-process-macro-additional">Using Process Macro (additional)</a>
  <ul class="collapse">
  <li><a href="#running-the-process-macro" id="toc-running-the-process-macro" class="nav-link" data-scroll-target="#running-the-process-macro">Running the Process Macro</a></li>
  <li><a href="#outputs" id="toc-outputs" class="nav-link" data-scroll-target="#outputs">Outputs</a></li>
  </ul></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="lab6.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<section id="sec-lab6" class="level1">
<h1>Mediation Analysis (Extra)</h1>
<p>Data: RobotGLP.sav</p>
<p>Data is available on ‘Workshop Materials’ folder on Moodle.</p>
<section id="learning-objectives" class="level2">
<h2 class="anchored" data-anchor-id="learning-objectives">Learning objectives</h2>
<p>This is an extra lab exercise that you do on your own time.</p>
<p>The aim of this lab is to help you to use SPSS to conduct mediation analysis.</p>
<p>Learning objectives:</p>
<p>At the end of this lab, I hope that you will</p>
<ul>
<li><p>Understand the concept of mediation.</p></li>
<li><p>Understand the meaning of total effect, direct effect and indirect effect.</p></li>
<li><p>Understand the Baron and Kenny’s procedure in examining mediation effect and its limitation.</p></li>
<li><p>Know how to use SPSS and interpret its outputs in mediation analysis.</p></li>
<li><p>Know how to test a mediation model using Process macro.</p></li>
</ul>
</section>
<section id="the-model" class="level2">
<h2 class="anchored" data-anchor-id="the-model">The Model</h2>
<p>We start with the following model where consumers’ environmental concerns (<code>EC</code>) is hypothesized to explain their intentions to join a green loyalty program (<code>Intention</code>).</p>
<div id="fig-slr" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/lab6_model1.png" title="Simple linear regression model" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;1: Simple linear model</figcaption>
</figure>
</div>
<p>and the model in <a href="#fig-med">Figure&nbsp;2</a> with anticipated guilt (<code>Guilt</code>) being added.</p>
<div id="fig-med" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/lab6_model2.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2: Mediation model</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task
</div>
</div>
<div class="callout-body-container callout-body">
<p>From the two figures above, identify the independent variable, dependent variable, and mediator variable?</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task: Fill in the blank
</div>
</div>
<div class="callout-body-container callout-body">
<p>If c in <a href="#fig-slr">Figure&nbsp;1</a> is the regression estimate that explains the impact of <code>EC</code> on <code>Intention</code>.</p>
<p>Write down the simple linear regression equation: ………. (<strong>Model 1</strong>).</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task: Fill in the blanks
</div>
</div>
<div class="callout-body-container callout-body">
<p>From Figure <a href="#fig-med">Figure&nbsp;2</a>, write down regression equations that relate:</p>
<ol type="1">
<li><p><code>Guilt</code> with <code>EC</code>: ………. (<strong>Model 2</strong>)</p></li>
<li><p><code>Intention</code> with both <code>EC</code> and <code>Guilt</code>: ………. (<strong>Model 3</strong>)</p></li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task: Fill in the blanks
</div>
</div>
<div class="callout-body-container callout-body">
<p>Identify</p>
<p>1. Total effect: ………</p>
<p>2. Direct effect: ……….</p>
<p>3. Indirect/mediated effect: ………., which is equal to c-c’.</p>
<p>Thus, Total effect = ………. + ……….</p>
</div>
</div>
<p>In this lab, we are going to use Baron and Kenny’s procedure (1986)<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> in examining the mediation effect. Note that nowadays this procedure loses its popularity in academic research because of its limitations. For example, the procedure assumes that the total effect of X on Y should be significant in the first place before proceeding to testing whether M affects the relationship. However, given this limitation, it is still important to appreciate this technique as it provides a basic understanding of a simple mediation model. Furthermore, in many cases, when mediation exists, the total effect of X on Y is significant.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task: Fill in the blanks
</div>
</div>
<div class="callout-body-container callout-body">
<p>Given the models above, following the BK’s procedure, there are three sets of preconditions that must be satisfied in mediation analysis, namely:</p>
<ol type="1">
<li><p>EC has a significant effect on ………</p></li>
<li><p>EC support has a significant effect on ………</p></li>
<li><p>Guilt has a significant effect on Intention when controlling for the effect of ………</p></li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task: Fill in the blanks
</div>
</div>
<div class="callout-body-container callout-body">
<p>To investigate the three preconditions in the previous task, we use regression analysis, in which:</p>
<p>Precondition 1 is tested via running a regression model as seen in Figure …..</p>
<p>Precondition 2 is tested via running a regression model as seen in Figure …..</p>
<p>Precondition 3 is tested via running a regression model as seen in Figure …..</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task
</div>
</div>
<div class="callout-body-container callout-body">
<p>Use SPSS to check for the above preconditions. Insert regression standardized estimates and their standard errors replacing the question marks into the figures below and put asterisk next to it if the coefficients are significant (e.g., 0.32(0.12)<strong>,</strong> p&lt;0.05. 0.32 is a standardized estimate and 0.12 is a standard error and the coefficient is significant because its p-value is less than 0.05).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/lab6_model3.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption class="figure-caption">Replace the question marks with numbers</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sobels-test" class="level2">
<h2 class="anchored" data-anchor-id="sobels-test">Sobel’s test</h2>
<p>Next, to assess whether mediation effect is significant, Baron and Kenny (1986) recommended researchers to directly assess whether the product <span class="math inline">\(a*b\)</span> is significant by using a Sobel’s test.</p>
<p>Use the online Sobel’s test by clicking this link <a href="http://quantpsy.org/sobel/sobel.htm" class="uri">http://quantpsy.org/sobel/sobel.htm</a>. To implement the Sobel’s test, you need to use the <strong>unstandardized</strong> estimates and their <strong>standard errors</strong>. But before inputting numbers into the above website, please put the necessary information in the table below:</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>##Task: Fill in the blanks</p>
<table class="table">
<thead>
<tr class="header">
<th>Unstandardized estimate</th>
<th>Standard error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(a\)</span> =</td>
<td><span class="math inline">\(S_a\)</span> =</td>
</tr>
<tr class="even">
<td><span class="math inline">\(b\)</span> =</td>
<td><span class="math inline">\(S_b\)</span> =</td>
</tr>
</tbody>
</table>
<p>Now, run the Sobel’s test.</p>
<p>What do you conclude??</p>
</div>
</div>
<p>The Sobel’s test assumes that the path coefficients a, b to be normally distributed but the product a*b need not normally distributed. Because of this reason researchers abandon this test and opt for a modern method of testing mediation explained in the next section.</p>
</section>
<section id="using-process-macro-additional" class="level2">
<h2 class="anchored" data-anchor-id="using-process-macro-additional">Using Process Macro (additional)</h2>
<p>Go to this website <a href="http://processmacro.org/download.html" class="uri">http://processmacro.org/download.html</a>, and download the Process macro, and install it onto your SPSS. The procedure of installing the macro is the same the one you did before when installing my heteroskedasticityV3 macro in the previous lab. So, if you managed to install my macro, you should be able to install this macro easily.</p>
<p>We are going to use this macro to test our mediation model. By using this macro, you do not need to follow the three steps procedure suggested by Baron and Kenny (1986). The macro implements what a so called ‘Bootstrapping’ technique. Bootstrapping is a resampling technique where your data is treated as a population, and the macro keeps taking samples from your data with replacement according a pre-specified number (the default of the program is 5000 samples). For each sample, the macro computes <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, and the product <span class="math inline">\(a*b\)</span>. Therefore, by having 5000 samples, there would be 5000 values of product <span class="math inline">\(a*b\)</span>. Using these 5000 values of the product <span class="math inline">\(a*b\)</span>, the macro calculates the confidence interval for the product <span class="math inline">\(a*b\)</span> – it is called a bootstrap confidence interval. <strong>If the interval does not include zero, the mediation effect is significant</strong>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>By default, the Process macros set the level of bootstrap confidence at 95% level. You can change this value but 95% is commonly used, therefore, leave the default as it is.</p>
<p>For example, if the 95% bootstrap confidence interval for the size of the mediation effect is [0.04;0.25]. This means that we are 95% confident that the effect lies from 0.04 to 0.25.</p>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>If the bootstrap confidence interval includes zero, the mediation effect is <strong>not</strong> significant.</p>
<p>For example, if the confidence interval is [-0.3; 0.2], the mediation effect is not significant.</p>
</div>
</div>
<section id="running-the-process-macro" class="level3">
<h3 class="anchored" data-anchor-id="running-the-process-macro">Running the Process Macro</h3>
<ul>
<li><p>Click <strong>Analyze</strong><span class="math inline">\(\rightarrow\)</span><strong>Regression</strong><span class="math inline">\(\rightarrow\)</span><strong>Process</strong></p></li>
<li><p>Insert <code>Intent</code> into <code>Y-variable</code> box.</p></li>
<li><p>Insert ’EC<code>into</code>X-variable` box.</p></li>
<li><p>Insert ‘Guilt’ into ‘Mediators(M)’ box.</p></li>
<li><p>Change <code>Model number</code> to 4.</p></li>
<li><p>If you manage to follow these steps, on your SPSS screen, you should see the figure below</p></li>
<li><p>Click <code>OK</code> – inspect the outputs.</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/lab6_process_win.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption class="figure-caption">Process Macro</figcaption>
</figure>
</div>
</section>
<section id="outputs" class="level3">
<h3 class="anchored" data-anchor-id="outputs">Outputs</h3>
<p>Inspect the outputs. The most important output to look at is the last part of the outputs – see <a href="#fig-processout">Figure&nbsp;3</a>. It gives you the size of the mediation effect (<span class="math inline">\(a*b=0.133\)</span>), and the lower and upper limit of the bootstrap confidence interval (0.04; 0.25). Because the 95% bootstrap confidence interval does not include zero, the mediation effect is significant.</p>
<div id="fig-processout" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/lab6_process_out.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3: Last part of the Process macro’s outputs</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task
</div>
</div>
<div class="callout-body-container callout-body">
<p>Look at the other parts of the Process macro’s outputs in your SPSS.</p>
<p>I want you to interpret the outputs of the macro in the other blocks, most importantly under</p>
<ol type="1">
<li><p><code>OUTCOME VARIABLE: Guilt</code> and</p></li>
<li><p><code>OUTCOME VARIABLE: Intent</code></p></li>
</ol>
</div>
</div>


</section>
</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Baron, Reuben M and David A. Kenny. 1986. The Moderator-mediator variable distinction in social psychological research: Conceptual strategic and statistical considerations. Journal of Personality and Social Psychology. 51(6), 1173-1182<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>