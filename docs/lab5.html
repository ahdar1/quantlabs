<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>MKTG402(3) Labs – lab5</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./lab5.html">Regression (Week 17)</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">MKTG402(3) Labs</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting started with SPSS (Week 13)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Descriptive Statistics, Graphs and Charts in SPSS (Week 14)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Crosstabs and Two Independent Samples T-test (Week 15)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ANOVA and Experimentation (Week 16)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab5.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Regression (Week 17)</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#sec-lab5" id="toc-sec-lab5" class="nav-link active" data-scroll-target="#sec-lab5">Regression (Week 17)</a>
  <ul class="collapse">
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link" data-scroll-target="#learning-objectives">Learning objectives</a></li>
  <li><a href="#why-regression" id="toc-why-regression" class="nav-link" data-scroll-target="#why-regression">Why Regression</a></li>
  <li><a href="#conducting-multiple-regression-with-spss" id="toc-conducting-multiple-regression-with-spss" class="nav-link" data-scroll-target="#conducting-multiple-regression-with-spss">Conducting Multiple Regression with SPSS</a></li>
  <li><a href="#multicollinearity-problems" id="toc-multicollinearity-problems" class="nav-link" data-scroll-target="#multicollinearity-problems">Multicollinearity Problems</a></li>
  <li><a href="#if-multicollinearity-exists" id="toc-if-multicollinearity-exists" class="nav-link" data-scroll-target="#if-multicollinearity-exists">If Multicollinearity Exists</a></li>
  <li><a href="#heteroskedasticity-problem" id="toc-heteroskedasticity-problem" class="nav-link" data-scroll-target="#heteroskedasticity-problem">Heteroskedasticity Problem</a></li>
  <li><a href="#sec-install" id="toc-sec-install" class="nav-link" data-scroll-target="#sec-install">Installing the HeteroskedasticityV3 Macro</a></li>
  <li><a href="#running-the-macro-without-installation" id="toc-running-the-macro-without-installation" class="nav-link" data-scroll-target="#running-the-macro-without-installation">Running the Macro without Installation</a></li>
  <li><a href="#video" id="toc-video" class="nav-link" data-scroll-target="#video">Video</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="lab5.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<section id="sec-lab5" class="level1">
<h1>Regression (Week 17)</h1>
<p>Data: RobotGLP.sav</p>
<p>Data is available on ‘Workshop Materials’ folder on Moodle.</p>
<section id="learning-objectives" class="level2">
<h2 class="anchored" data-anchor-id="learning-objectives">Learning objectives</h2>
<p>The aim of this lab is to help you to use SPSS to conduct regression analysis, which is useful in explaining the relationship between a set of <em>independent</em> variables and a <em>dependent variable</em>.</p>
<p>At the end of this lab, we hope that you will be able to</p>
<ul>
<li><p>Understand the meaning of independent and dependent variables</p></li>
<li><p>Select appropriate independent variables to explain a dependent variable</p></li>
<li><p>Produce and interpret basic SPSS outputs for multiple regression</p></li>
<li><p>Understand the meaning of multicollinearity, how to detect and remedy it</p></li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>FYI, many students of the previous cohorts used regression when they wrote their MSc dissertations.</p>
</div>
</div>
</section>
<section id="why-regression" class="level2">
<h2 class="anchored" data-anchor-id="why-regression">Why Regression</h2>
<p>In marketing research, we often need to determine the impact of a set of marketing variables on one variable – a factor we want to understand or predict. Furthermore, among those variables we may want to find out which variables matter most, and which variables are not so important that we can ignore. Regression analysis can help us findings the answers to these questions.</p>
<p>In this workshop, we want to investigate factors that influence consumers’ decision to join a green loyalty program – This LP encourages behaviours from hotel guests that are good for environment (e.g., reuse towels).</p>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="images/lab5_robot.jpg" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption class="figure-caption">Hotel receptionist (Image courtesy of Jingxi)</figcaption>
</figure>
</div>
<p>In this lab, we consider the following case. A hotel manager who recently launch a green loyalty program (GLP) wants to know about factors that affect consumers’ intention to join the hotel GLP. The hotel manager decides to develop a survey and asks the hotel’s guests to fill in an offline survey. The survey form was handed in to hotel guests by a frontline service robot (see the image above). The survey contains items to measure the following constructs:</p>
<ul>
<li><p>Intention to join the green loyalty program</p></li>
<li><p>Anticipated guilt if not joining the green loyalty program</p></li>
<li><p>Perceived attractiveness of hotel receptionist</p></li>
<li><p>Age</p></li>
<li><p>Gender</p></li>
</ul>
<p><code>Anticipated guilt</code>, <code>Perceived Attractiveness</code>, <code>Age</code>, <code>Gender</code> are called the independent variables and <code>Intention to join the green loyalty program</code> is the dependent variable. The notion of the dependent variable comes from our prediction that its value depends on the values of the independent variables. The relationship between <code>Intention to join the green LP</code> the and the four independent variables can be written as:</p>
<p>Intention to join the green LP ~ Anticipated Guilt + Perceived Attractiveness + Age + Gender + error.</p>
<p>You can read the above expression as a consumer’ intention to join the green loyalty program is influenced by the consumer’s anticipated of guilt, perceived attractiveness, age, and gender, and some unknown factors represented by an error term. The relationship can be represented by a mathematical expression as below. The names of the variables are shortened.</p>
<span class="math display">\[\begin{equation}
Intent = \beta_0 +  \beta_1 * Guilt + \beta_2 * Attract + \beta_3 * Age + \beta_4 * Gender.
\end{equation}\]</span>
<p>where <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span>, <span class="math inline">\(\beta_2\)</span>, <span class="math inline">\(\beta_3\)</span>, and <span class="math inline">\(\beta_4\)</span> are parameters that capture the impact of each of the independent variables on <code>intention</code>.</p>
<p>We use regression procedure in SPSS to find out the estimates for all parameters using sample data (<span class="math inline">\(\beta_0\)</span> is just a constant so it is not of our interest).</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Variable <code>Intent</code>, <code>Guilt</code>, and <code>Attract</code> were average scores of a multi-item scale where each item in the scale were measured using a Likert scale ranging from 1 = strongly disagree to 7=strongly agree. <code>Age</code> is a continuous variable, and <code>Gender</code> is a 0,1 variable.</p>
</div>
</div>
<p>If you want to examine whether <code>Guilt</code> is a significant factor, then you want to test <span class="math inline">\(H0\)</span>: <span class="math inline">\(\beta_1=0\)</span> against <span class="math inline">\(H1\)</span>: <span class="math inline">\(\beta_1 \ne 0\)</span>. SPSS will report the p-value associated with <span class="math inline">\(H0\)</span>. If p-value is less than 0.05, you reject <span class="math inline">\(H0\)</span> otherwise retain it. If you reject <span class="math inline">\(H0\)</span>, you can conclude that <code>Guilt</code> is a significant factor that influences <code>intent</code>.</p>
<p>If you hypothesize that <code>Guilt</code> is a significant factor and has a positive impact on satisfaction, then you want to test <span class="math inline">\(H0\)</span>: <span class="math inline">\(\beta_1=0\)</span> against <span class="math inline">\(H1\)</span>: <span class="math inline">\(\beta_1 &gt; 0\)</span>. SPSS will report the p-value associated with <span class="math inline">\(H0\)</span>. You have to divide the p-value by 2. If the p-value/2 is less than 0.05, you reject <span class="math inline">\(H0\)</span> otherwise retain it. If you reject <span class="math inline">\(H0\)</span>, you can conclude that <code>Guilt</code> has a significant positive influence on <code>Intent</code>.</p>
</section>
<section id="conducting-multiple-regression-with-spss" class="level2">
<h2 class="anchored" data-anchor-id="conducting-multiple-regression-with-spss">Conducting Multiple Regression with SPSS</h2>
<p><strong>Open RobotGLP.sav</strong> – Thanks to <a href="https://www.lancaster.ac.uk/lums/people/jingxi-huang">Jingxi</a> for allowing us to use a subset of her data to test the above model.</p>
<p>To conduct a regression analysis in SPSS, click the following: <strong>Analyze</strong><span class="math inline">\(\rightarrow\)</span><strong>Regression</strong><span class="math inline">\(\rightarrow\)</span><strong>Linear.</strong></p>
<p>Enter <code>Intent</code> into the dependent variable box.</p>
<p>Enter <code>Guilt</code>,<code>Attract</code>, <code>Age,</code>Gender` into the independent variable(s) box.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/lab5_ols.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
<p>Click <code>OK</code></p>
<p>SPSS produces four tables. The first one does not offer much information. Therefore, we focus our attention to the next three tables.</p>
<ol type="1">
<li><p>ANOVA table: Is the model meaningful?</p>
<p><img src="images/lab5_anova.png" class="img-fluid" style="width:70.0%"></p></li>
</ol>
<p>This table tells whether or not the model is meaningful. If the sig value is less than 0.05, then the model is meaningful. If p-value is greater than 0.05, then model should be dismissed and don’t interpret other outputs. In this example, the sig. value is less than 0.05; therefore we have a meaningful model. We can proceed with the next output.</p>
<ol start="2" type="1">
<li>Model Summary table: How good is the model?</li>
</ol>
<p>Having known the model is meaningful, how do we know whether it is good enough? The Model Summary table provides the answer to this question.</p>
<p><img src="images/lab5_rsq.png" class="img-fluid" style="width:70.0%"></p>
<p>The model summary table tells you how well the independent variables explain variation in the dependent variable. The adjusted <span class="math inline">\(R^2\)</span> is 0.311 indicating that about 31% of the variation in the intention score is explained by the four independent variables (Guilt, Attract, Age, and Gender). Theoretically, the maximum possible value for adjusted R-square is 100% indicating a perfect model!</p>
<p>Adjusted <span class="math inline">\(R^2\)</span> is <span class="math inline">\(R^2\)</span> that is adjusted for the number of independent variables in the model. The more independent variable you have in the model, the larger the <span class="math inline">\(R^2\)</span> will be. The adjusted <span class="math inline">\(R^2\)</span> prevents the inflation. You can use the following convention to qualify the impact of the set of the independent variables on the dependent variable<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>:</p>
<p><span class="math inline">\(R^2\)</span> ≥ 0.02 small effect</p>
<p>≥ 0.13 medium</p>
<p>≥ 0.26 large</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task
</div>
</div>
<div class="callout-body-container callout-body">
<p>Knowing the adjusted <span class="math inline">\(R^2\)</span>, indicate the strength of the impact of Guilt, Attract, Age, and Gender.</p>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Maximizing <span class="math inline">\(R^2\)</span> value should not be your main goal in regression. Do not be tempted to select variables with the aim of increasing <span class="math inline">\(R^2\)</span> value. <span class="math inline">\(R^2\)</span> value in social sciences are typically in the range of 0.1 to 0.5. Selecting variables should be motivated by theories.</p>
</div>
</div>
<ol start="3" type="1">
<li>Coefficients</li>
</ol>
<p><img src="images/lab5_coefs.png" class="img-fluid" style="width:110.0%"></p>
<p>This table tells us which of the independent variables significantly explain or predict the dependent variable. In this case three variables significantly explain <code>Intent</code>. These are <code>Guilt</code>, <code>Attract</code>, and <code>Age</code>, whereas <code>Gender</code> is not significant. Furthermore, the standardized beta values tell us which variable has the strongest impact on <code>Intent</code>. In this case <code>Attract</code> is the strongest predictor followed by <code>Guilt</code> and <code>Age</code>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you want to make a prediction, use the unstandardized coefficients (B). If someone assigns a rating of three on <code>Guilt</code>, <code>Attract</code> can you predict her intention level? (round-off your answer)</p>
</div>
</div>
</section>
<section id="multicollinearity-problems" class="level2">
<h2 class="anchored" data-anchor-id="multicollinearity-problems">Multicollinearity Problems</h2>
<p>High correlation among independent variables is problematic in multiple regression because it is hard for us to determine the individual contribution of each of the independent variables in the model. For example, if <code>Attract</code> is highly correlated with <code>Guilt</code>, then we cannot conclude that <code>Attract</code> have the strongest influence on <code>Intent</code> because <code>Guilt</code> also gives contribution to the magnitude of Attract-Intent relationship (it looks stronger than it should be). In other words, the coefficients associated with the regression estimates are biased – not the same as their true population values.</p>
<p>The situation where an independent variable is highly correlated with another variable is referred to as multicollinearity problem. To diagnose whether multicollinearity exists, you can check it in two ways.</p>
<ol type="1">
<li>Inspect the correlation coefficient among the independent variables. To do correlation analysis in SPSS, follow this step: <strong>Analyze</strong><span class="math inline">\(\rightarrow\)</span><strong>Correlation</strong><span class="math inline">\(\rightarrow\)</span><strong>Bivariate</strong>. If two variables is highly correlated with the correlation coefficient is larger than 0.9, your model may suffer from a multicollinearity problem. In practice, you should be cautious, if the correlation is 0.7.</li>
</ol>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task
</div>
</div>
<div class="callout-body-container callout-body">
<p>Check the correlation coefficients among the predictors in the model.</p>
</div>
</div>
<ol start="2" type="1">
<li>Rerun your regression.</li>
</ol>
<ul>
<li><p>Click: <strong>Analyze</strong><span class="math inline">\(\rightarrow\)</span><strong>Regression</strong><span class="math inline">\(\rightarrow\)</span><strong>Linear</strong>.</p></li>
<li><p>Click <code>Statistics</code> options.</p></li>
<li><p>Select <code>Collinearity diagnostic</code>. Click <code>Continue</code> and Click <code>OK</code>.</p></li>
<li><p>Inspect the <strong>VIF (Variance Inflation Factor</strong> values in the output.</p></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Multicollinearity exists if VIF (variance inflation factor) &gt; 10.</p>
</div>
</div>
<p><img src="images/lab5_vif.png" class="img-fluid" style="width:110.0%"></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task
</div>
</div>
<div class="callout-body-container callout-body">
<p>See the above output, does the model suffer from a multicollinearity problem?</p>
</div>
</div>
</section>
<section id="if-multicollinearity-exists" class="level2">
<h2 class="anchored" data-anchor-id="if-multicollinearity-exists">If Multicollinearity Exists</h2>
<p>What should you do if multicollinearity exists?</p>
<p>You can deal with it using one of the following techniques:</p>
<ol type="1">
<li><p>Omit one or more highly correlated independent variables</p></li>
<li><p>Create a composite variable e.g., by taking the average score of two variables if the two variables causes multicollinearity <strong>averaging</strong> or using Principle Component Analysis (beyond the scope of our workshops)</p></li>
<li><p>Use the model that suffers from multicollinearity but for prediction purposes only.</p></li>
<li><p>Collect more samples</p></li>
</ol>
</section>
<section id="heteroskedasticity-problem" class="level2">
<h2 class="anchored" data-anchor-id="heteroskedasticity-problem">Heteroskedasticity Problem</h2>
<p>One of the assumptions in regression is that residuals or errors should be constant across any values of independent variables. This is referred to as the <strong>homoskedasticity</strong> assumption. The opposite of homoskedasticity is <strong>heteroskedasticity</strong> where residuals are not constant (i.e., heteroskedastic errors) (<em>learn how to pronounce these words, it took me a while to get used to them!</em>).</p>
<p>If heteroskedasticity exists, hypotheses tests about the regression parameters are not correct anymore. See lecture slide for more details. One of the recommended techniques to handle heteroskedasticity is to adjust the standard errors of the regression estimates (i.e., values in the <code>Std. error</code> column in the SPSS output).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task
</div>
</div>
<div class="callout-body-container callout-body">
<p>Rerun your regression with heteroskedasticity-adjusted standard errors and compare the results with the original regression you had previously conducted. Continue reading the text below.</p>
</div>
</div>
<p>To rerun your regression, install and use the ‘HeteroskedasticityV3.spd’ macro developed by yours truly<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. The macro produces regression outputs with/without heteroscedasticity-adjusted standard errors.</p>
</section>
<section id="sec-install" class="level2">
<h2 class="anchored" data-anchor-id="sec-install">Installing the HeteroskedasticityV3 Macro</h2>
<p>SPSS in the Lab PCs or from cloud may not permit you to install the add-on macro because you do not have an admin right to do so. However, it is worth trying to install the macro, it may work! Alternatively, you need to install the macro in your personal PC where you have an admin right to install it.</p>
<p>You can download the macro from these websites:</p>
<ul>
<li><p><a href="https://github.com/ahmaddaryanto/Heteroskedasticity" class="uri">https://github.com/ahmaddaryanto/Heteroskedasticity</a></p></li>
<li><p>Click the green button <code>Code</code>, and select <code>Download ZIP</code>.</p></li>
<li><p>Go to the download folder on your PC or laptop.</p></li>
<li><p>Locate the HeteroskedasticityV3.spd and install.</p></li>
<li><p>If you have an admin right, double click the file, and follow the instruction on your screen</p></li>
<li><p>If the above does not work, click <strong>Extensions</strong><span class="math inline">\(\rightarrow\)</span><strong>Utilities</strong><span class="math inline">\(\rightarrow\)</span><strong>Install Custom Dialog</strong>. Locate the file, and install.</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/lab5_macro_path.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">HeteroskedaticityV3 Macro in the SPSS menu after installation</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/lab5_macro.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">HeteroskedaticityV3 Macro</figcaption>
</figure>
</div>
<p>If you do not manage to install the macro. Do not panic! There is another option without installation – see below:</p>
</section>
<section id="running-the-macro-without-installation" class="level2">
<h2 class="anchored" data-anchor-id="running-the-macro-without-installation">Running the Macro without Installation</h2>
<p>You can run the macro without having it installed on your machine. Follow these steps:</p>
<ul>
<li><p>Go back to the download folder in your PC where you have downloaded several files from this page <a href="https://github.com/ahmaddaryanto/Heteroskedasticity" class="uri">https://github.com/ahmaddaryanto/Heteroskedasticity</a> (see <a href="#sec-install">Section&nbsp;1.7</a>)</p></li>
<li><p>HeteroskedasticityV3.sps was included when you download the files from the github page.</p></li>
<li><p>Open the HeteroskedasticityV3.sps on your SPSS – it will be opened as a syntax file,</p></li>
<li><p>Run the syntax file (highlight all the lines, run the selection button, i.e., the green button).</p></li>
<li><p>Next, open this file: <strong>Runthemacro.sps</strong>.</p></li>
<li><p>Change the DV and IVs according to your model specifications, and</p></li>
<li><p>Run the file.</p></li>
</ul>
</section>
<section id="video" class="level2">
<h2 class="anchored" data-anchor-id="video">Video</h2>
<p><a href="https://dtu-panopto.lancs.ac.uk/Panopto/Pages/Viewer.aspx?id=a8f3e3c0-35c3-477c-950f-afa3007195b2">Lecture Week 16 on Correlation and Regression</a></p>
<p><a href="https://dtu-panopto.lancs.ac.uk/Panopto/Pages/Viewer.aspx?id=074239e8-f79d-4ffb-8754-ac9400f4f00f">Regression with a categorical iv</a></p>
<p><a href="https://dtu-panopto.lancs.ac.uk/Panopto/Pages/Viewer.aspx?id=5ba02b44-b4d1-4b70-ab45-acb900dc20a4">Regression diagnostics</a></p>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Ellis, Paul D. 2011. The Essential Guide to Effect Sizes, p.41<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Daryanto, A. (2020). Tutorial on heteroskedasticity using heteroskedasticityV3 SPSS macro. The Quantitative Methods for Psychology, 16(5), 8-20<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>